% \documentclass[12pt,a4paper]{article}
\documentclass{iopjournal}

% Packages for math, symbols, and formatting
\usepackage{fix-cm}                       % Allow arbitrary font sizes
\usepackage{amsmath, amssymb, amsfonts}  % Standard math packages
\usepackage{graphicx}                     % For figures
\usepackage{hyperref}                     % For links
% \usepackage{geometry}                     % Page layout
\usepackage{caption}                      % Captions for figures/tables
\usepackage{bm}                           % Bold math symbols

% Add bibilography
\usepackage[backend=biber,style=numeric, sorting=none]{biblatex}
\addbibresource{CW-FWM-Analytic-Solutions.bib}

% Page layout
% \geometry{top=2.5cm, bottom=2.5cm, left=2.5cm, right=2.5cm}

% Fix plot positions
\usepackage{float}

% Numbering equations by section
\numberwithin{equation}{section}

% Title and authors
% \title{The analytic solution to four-wave mixing in nonlinear fibers in Weierstrass notation}
% \author{Graham Hesketh \\
% \small United Kingdom \\
% \small \texttt{gdh1e10@gmail.com}}

% \date{\today}

\begin{document}

% \articletype{Paper}
\title{The analytic solution to four-wave mixing in nonlinear fibers in Weierstrass notation}
\author{Graham Hesketh}
\email{gdh1e10@gmail.com}

\keywords{sample term, sample term, sample term}

% \maketitle

\begin{abstract}
The general analytic solution to continuous-wave four-wave mixing in nonlinear optical fibers is presented in terms of Weierstrass elliptic $\wp, \sigma, \zeta$ functions. 
Solutions are provided for the full complex envelopes for all four frequencies, under all initial conditions, and without any undepleted pump approximation. 
A canonical coordinate system is identified in which solutions simplify to Kronecker theta functions.
\end{abstract}


% ---------- SECTION -------------
% --------------------------------

% \section{Introduction}
% Four-wave mixing (FWM) in nonlinear optical fibers is one of the fundamental parametric processes enabled by the Kerr nonlinearity. 
% It underpins a wide range of applications, including wavelength conversion, parametric amplification, ultrafast signal processing, frequency-comb generation, and quantum light sources (see \cite{agrawalNonlinearFiberOptics2019} and references therein). 
% Despite this broad relevance, obtaining closed-form analytic descriptions of FWM remains challenging because the underlying coupled-wave equations are nonlinear and phase-sensitive. 
% As a result, most textbook treatments rely on simplifying assumptions such as undepleted pumps, identical effective mode areas, negligible phase mismatch, or weak signal and idler powers.

% Two notable bodies of work have previously presented relevant analytic solutions for four-wave mixing. 
% Firstly, in \cite{chenFourphotonParametricMixing1989, chenFourwaveMixingOptical1989} solutions for the power in each of the frequency modes is derived by inverting elliptic integrals to obtain elliptic functions.
% Secondly, in \cite{marhicAnalyticSolutionsPhases2013} elliptic integrals are given for the phases for each mode. Both works use Jacobi elliptic functions. 
% In contrast, the work herein derives complete solutions for the complex mode envelopes themselves, avoiding decomposition into amplitude and phase or real and imaginary parts, and does so using Weierstrass elliptic functions. 
% This is the first of the two main results of this paper.

%     The structure of the resulting analytic solutions naturally motivates a transformation to a new set of canonical coordinates. 
% Remarkably, although this transformation depends explicitly on the propagation variable $z$, it leaves the coupled differential equations structurally invariant, preserving the characteristic interaction terms of four-wave mixing dynamics. 
% At the same time, the transformation leads to a substantial simplification of both the analysis and the solutions which become single-valued meromorphic functions, specifically Kronecker theta functions. 
% This is the second of this papers main results.
% The emergence of Kronecker theta functions establishes a direct connection between four-wave mixing and other nonlinear optical systems \cite{heskethGeneralComplexEnvelope2015}. 
% Within this framework, the four-wave mixing system is cast as a canonical Hamiltonian system, and the associated conservation laws are shown to arise from the Frobenius–Stickelberger determinant formula.

\section{Introduction}
Four-wave mixing (FWM) in nonlinear optical fibers is one of the fundamental parametric processes enabled by the Kerr nonlinearity. 
It underpins a wide range of applications, including wavelength conversion, parametric amplification, ultrafast signal processing, frequency-comb generation, and quantum light sources (see \cite{agrawalNonlinearFiberOptics2019} and references therein). 
Despite this broad relevance, obtaining closed-form analytic descriptions of FWM remains challenging because the underlying coupled-wave equations are nonlinear and phase-sensitive. 
As a result, most textbook treatments rely on simplifying assumptions such as undepleted pumps, identical effective mode areas, negligible phase mismatch, or weak signal and idler powers.

Two notable bodies of work have previously presented relevant analytic solutions for four-wave mixing. 
Firstly, in \cite{chenFourphotonParametricMixing1989, chenFourwaveMixingOptical1989} solutions for the power in each of the frequency modes is derived by inverting elliptic integrals to obtain elliptic functions.
Secondly, in \cite{marhicAnalyticSolutionsPhases2013} elliptic integrals are given for the phases for each mode. 
Both works use Jacobi elliptic functions and treat amplitude and phase separately.
In contrast, the work herein derives complete solutions for the complex mode envelopes themselves, avoiding decomposition into amplitude and phase or real and imaginary parts, which provides a more direct description that naturally preserves all phase relationships and may therefore provide benefits for coherent applications.

The solutions derived herein are expressed using Weierstrass elliptic functions rather than the Jacobi elliptic functions employed in prior work.
The Weierstrass formulation provides a natural solution pathway for complex envelopes: the coupled equations are recast as logarithmic derivatives, which directly yield Weierstrass $\zeta$ functions, and integration then produces solutions in terms of Weierstrass $\sigma$ functions.
This progression through the Weierstrass function hierarchy—from $\wp$ to $\zeta$ to $\sigma$—emerges organically from the structure of the complex envelope equations, whereas Jacobi elliptic functions are more naturally suited to systems where amplitudes and phases are treated separately.
Moreover, the connection to Hamiltonian structure and conservation laws is more transparent in Weierstrass notation.
In particular, we show that the Hamiltonian conservation arises from the Frobenius--Stickelberger determinant formula, an elliptic function identity most naturally expressed using Weierstrass functions.
This identification may facilitate future generalizations to higher-order mixing processes or multimode systems. 
The Weierstrass form also establishes a common framework with other integrable nonlinear optical systems \cite{heskethGeneralComplexEnvelope2015}.
The derivation of these complete analytic solutions in Weierstrass notation is the first of the two main results of this paper.

The structure of the resulting analytic solutions naturally motivates a transformation to a new set of canonical coordinates. 
Remarkably, although this transformation depends explicitly on the propagation variable $z$, it leaves the coupled differential equations structurally invariant, preserving the characteristic interaction terms of four-wave mixing dynamics. 
At the same time, the transformation leads to a substantial simplification: the solutions become single-valued meromorphic functions, specifically Kronecker theta functions, and the system parameters are greatly reduced or eliminated entirely.
The identification of solutions as Kronecker theta functions opens the door to leveraging known Fourier series and multipole expansions of these functions, which may prove useful for further analysis of four-wave mixing dynamics.
The canonical coordinates with Kronecker theta function solutions is the second of this paper's main results.

% ---------- SECTION -------------
% --------------------------------

\section{The quasi-continuous-wave four-wave mixing system}
In this section we recall the four-wave mixing system from nonlinear fiber optics that forms the focus of our study. 
The coupled system of ordinary differential equations in \eqref{eq:fwm-system} is taken from \cite{agrawalNonlinearFiberOptics2019} which credits \cite{stolenParametricAmplificationFrequency1982} with its creation. 
The system describes four-wave mixing in the quasi-continuous-wave limit, i.e., when time derivatives can be ignored.
Physically, the equations describe the evolution of four copropagating optical waves that exchange energy through the Kerr nonlinearity, with each wave experiencing both self-phase modulation (SPM), cross-phase modulation from other waves (XPM), and parametric coupling through the four-wave mixing terms

\begin{align}
\frac{dA_1}{dz} &= \frac{in_2\omega_1}{c}\left[\left(f_{11}|A_1|^2 + 2\sum_{k\neq 1} f_{1k}|A_k|^2\right)A_1 + 2f_{1234}A_2^*A_3A_4e^{i\Delta kz}\right], \notag \\
\frac{dA_2}{dz} &= \frac{in_2\omega_2}{c}\left[\left(f_{22}|A_2|^2 + 2\sum_{k\neq 2} f_{2k}|A_k|^2\right)A_2 + 2f_{2134}A_1^*A_3A_4e^{i\Delta kz}\right], \notag \\
\frac{dA_3}{dz} &= \frac{in_2\omega_3}{c}\left[\left(f_{33}|A_3|^2 + 2\sum_{k\neq 3} f_{3k}|A_k|^2\right)A_3 + 2f_{3412}A_1A_2A_4^*e^{-i\Delta kz}\right], \notag \\
\frac{dA_4}{dz} &= \frac{in_2\omega_4}{c}\left[\left(f_{44}|A_4|^2 + 2\sum_{k\neq 4} f_{4k}|A_k|^2\right)A_4 + 2f_{4312}A_1A_2A_3^*e^{-i\Delta kz}\right]. \label{eq:fwm-system}
\end{align}

where:
\begin{itemize}
    \item $A_j$ are the slowly-varying complex field amplitudes for waves $j = 1, 2, 3, 4$
    \item $z$ is the propagation distance
    \item $\omega_j$ are the angular frequencies of the respective waves
    \item $c$ is the speed of light in vacuum
    \item $n_2$ is the nonlinear refractive index
    \item $f_{jj}$ are the self-phase modulation (SPM) coefficients
    \item $f_{jk}$ (for $j \neq k$) are the cross-phase modulation (XPM) coefficients
    \item $f_{jklm}$ are the four-wave mixing (FWM) coefficients
    \item $A^*$ denotes complex conjugation
    \item $\Delta k = \beta_1 + \beta_2 - \beta_3 - \beta_4$ is the phase mismatch
    \item $\beta_j = n(\omega_j)\omega_j/c$ are the propagation constants
\end{itemize}

The modal overlap integrals are defined in terms of the transverse distribution of the fiber mode $F_j(x,y)$ as:
\begin{align}
\label{eq:overlaps}
f_{jklm} &= \frac{\langle F_j^* F_k^* F_l F_m \rangle}{\sqrt{\langle |F_j|^2 \rangle \langle |F_k|^2 \rangle \langle |F_l|^2 \rangle \langle |F_m|^2 \rangle}}, \\
f_{jk} &= f_{kj} = f_{jjkk}
\end{align}
where $\langle \cdots \rangle = \iint_{-\infty}^{\infty} (\cdots) \, dx\,dy$ denotes the transverse spatial integral.

Agrawal says of \eqref{eq:fwm-system} that the equations ``are quite general in the sense that they include the effects of SPM, XPM, and pump depletion on the FWM process'' and stresses that numerical or approximate solutions are commonly utilised.
Herein, they are solved analytically in full, as written.


% ---------- SECTION -------------
% --------------------------------

\section{The normalised system}
In this section we normalise and generalise the system, transforming it into a form that both simplifies the algebra and broadens the scope of applicability.
From \eqref{eq:overlaps}, we observe the following symmetries among the wave mixing coefficients:

\begin{align}
f_{1234} &= |f_{1234}|e^{i\varphi}, \notag \\
f_{2134} &= f_{1234} = |f_{1234}|e^{i\varphi}, \notag \\
f_{3412} &= f_{1234}^* = |f_{1234}|e^{-i\varphi}, \notag \\
f_{4312} &= f_{1234}^* = |f_{1234}|e^{-i\varphi}, \label{eq:overlap-symms}
\end{align}
where $\varphi$ is the phase of $f_{1234}$. 
The symmetries in \eqref{eq:overlap-symms} hold exactly for scalar (weakly guiding) fiber modes with instantaneous Kerr nonlinearity, but require vectorial generalization when polarization effects or strong guidance become important.
Assuming \eqref{eq:overlap-symms}, we can conveniently renormalise the functions, and also absorb the phase $\varphi$ as a global phase rotation of the modes, 
in such a way that the wave mixing coefficients all become equal to one.

To do so, we introduce the following redefinition of physical complex envelopes $A_j, A^*_j$ in terms of abstracted variables $u_j,v_j$.
The complex conjugates $A, A^*$ are distributed among $u,v$ in a particular pattern (note that $u_3, u_4$ involve $A^*_3, A^*_4$ while $v_3, v_4$ involve $A_3, A_4$) so as to later give one product over $u$ and one over $v$ in the wave mixing terms:

\begin{align}
T &= \sqrt{\frac{2\,n_2 \left|f_{1234}\right|}{c} \sqrt{ \prod\limits_{k=1}^{4} \omega_k}}, \label{eq:T-def} \\
u_1\left(z\right) &= \frac{T\,\,e^{-i\pi/4}\,e^{-i\varphi/4}}{\sqrt{\omega_{1}}} \,A_{1}\left(z\right)\,e^{i z \beta_{1}}, \notag \\
u_2\left(z\right) &= \frac{T\,e^{-i\pi/4}\,e^{-i\varphi/4}}{\sqrt{\omega_{2}}}\,A_{2}\left(z\right)\,e^{i z \beta_{2}}, \notag \\
u_3\left(z\right) &= \frac{T\,e^{i\pi/4}\,e^{-i\varphi/4}}{\sqrt{\omega_{3}}}\,A^*_{3}\left(z\right)\,e^{-i z \beta_{3}}, \notag \\
u_4\left(z\right) &= \frac{T\,e^{i\pi/4}\,e^{-i\varphi/4}}{\sqrt{\omega_{4}}}\,A^*_{4}\left(z\right)\,e^{-i z \beta_{4}}, \notag \\
v_1\left(z\right) &= \frac{T\,e^{-i\pi/4}\,e^{i\varphi/4}}{\sqrt{\omega_{1}}}\,A^*_{1}\left(z\right)\,e^{-i z \beta_{1}}, \notag \\
v_2\left(z\right) &= \frac{T\,e^{-i\pi/4}\,e^{i\varphi/4}}{\sqrt{\omega_{2}}}\,A^*_{2}\left(z\right)\,e^{-i z \beta_{2}}, \notag \\
v_3\left(z\right) &= \frac{T\,e^{i\pi/4}\,e^{i\varphi/4}}{\sqrt{\omega_{3}}}\,A_{3}\left(z\right)\,e^{i z \beta_{3}}, \notag \\
v_4\left(z\right) &= \frac{T\,e^{i\pi/4}\,e^{i\varphi/4}}{\sqrt{\omega_{4}}}\,A_{4}\left(z\right)\,e^{i z \beta_{4}}. \label{eq:u-v-A}
\end{align}

From this point on we do not assume that $u_j$ and $v_j$ are necessarily complex conjugates, but we will show in the following section that they are Hamiltonian conjugates with the physical four-wave mixing scenario being a particular realisation of a more general system.
In all that follows we refer to $u_j, v_j$ as modes, which we use as a general term for components of the coupled system that should not be confused with propagation modes of a multimode optical fiber. 
We refer to their product $u_j v_j$ as the modal power; while this quantity is not necessarily real-valued, the conceptual analogy is useful.

We subsequently introduce parameters $a_j, a_{j,k} \in \mathbb{C}$ which we refer to as propagation constants and phase modulation parameters respectively, again borrowing terminology by analogy.
In the four-wave mixing case these take the values:
\begin{align}
{a}_{j} &= - i\, s{\left(j \right)} {\beta}_{j}, \\
{a}_{j,k} &= {a}_{k,j} = - \frac{\left(\delta_{j k} - 2\right) s{\left(j \right)}\, s{\left(k \right)}\, {f}_{j,k}\, {\omega}_{j}\, {\omega}_{k}}{2 \left|{{f}_{1,2,3,4}}\right| \sqrt{\prod_{l=1}^{4} {\omega}_{l}}}
\end{align}
with $\delta$ the Kronecker delta function, and $s(j)$ defined such that $s(1) = s(2) = 1, s(3) = s(4) = -1$.
The four-wave mixing system in \eqref{eq:fwm-system} is then a special case of the more general system:
\begin{align}
\frac{d}{d z} u_j{\left(z \right)} &= - \left({a}_{j} + \sum_{k=1}^{4} {a}_{j,k}\,u_k v_k \right) u_j + \prod\limits_{k=1, k \ne j}^{4} v_k, \notag \\
\frac{d}{d z} v_j{\left(z \right)} &= \left({a}_{j} + \sum_{k=1}^{4} {a}_{j,k}\,u_k v_k \right) v_j - \prod\limits_{k=1, k \ne j}^{4} u_k. \label{eq:uv-system}
\end{align}
This form encompasses the most general coupled system that the methods herein solve and may facilitate future extensions to related systems such as parity-time (PT) symmetric configurations \cite{sarmaContinuousDiscreteSchrodinger2014}.


% ---------- SECTION -------------
% --------------------------------

\section{Conserved quantities}

In this section we identify conserved quantities of the system. 
The system in \eqref{eq:uv-system} can be formulated as the following canonical Hamiltonian system:
\begin{align}
\label{eq:ham-uv}
H(u_1,\dots, u_4, v_1, \dots, v_4) &= -\sum_{j=1}^{4} a_{j}\, u_j v_j - \frac{1}{2}\,\sum_{j,k=1}^{4} a_{j,k}\, u_j v_j u_k v_k + \prod\limits_{j=1}^{4} u_j + \prod\limits_{j=1}^{4} v_j, \\
\frac{d}{d z} u_j{\left(z \right)} &= \frac{\partial H}{\partial v_j}, \\
\frac{d}{d z} v_j{\left(z \right)} &= -\frac{\partial H}{\partial u_j}, \\
\frac{d}{d z} H &= 0
\end{align}

The conservation of $H$ is to be expected as a consequence of \eqref{eq:ham-uv} lacking an explicit $z$ dependence. The pair $u_j, v_j$ are Hamiltonian conjugates, and each pair represents one of four degrees of freedom in the system. 
The modal power $u_j v_j$ evolves according to:
\begin{equation}
\label{eq:duv_j} 
\frac{d}{d z} u_j v_j = - \prod\limits_{k=1}^{4} u_k + \prod\limits_{k=1}^{4} v_k
\end{equation}

As the right hand side of \eqref{eq:duv_j} is the same for all $j$, 
we may define constants $\gamma_j$ and function $\rho(z)$ such that:
\begin{equation}
\label{eq:uvj-gam-rho}
u_j(z) v_j(z) = \gamma_j - \rho(z)
\end{equation}

from which it follows that there are 3 (read as $j > k$ to avoid over counting) intermodal power conservation laws of the form:
\begin{equation}
\label{eq:power-conserved}
u_j(z) v_j(z) - u_k(z) v_k(z) = \gamma_j - \gamma_k.
\end{equation}

The system has 4 degrees of freedom and four conserved quantities which is a requirement for integrability in the Liouville-Arnold sense.
The $\gamma_j$ constants can be determined from \eqref{eq:power-conserved} and initial conditions, 
however, this provides three equations for four unknowns and thus a choice is available for normalisation. 
We choose to impose the constraint that:
\begin{equation}
\sum\limits_{j=1}^{4}\gamma_j = 0,
\end{equation} 
after which $\rho(z)$ is the mean modal power and $\gamma_j$ is the constant difference between a modes power and the mean.


% ---------- SECTION -------------
% --------------------------------

\section{Solutions for modal powers in terms of Weierstrass \texorpdfstring{$\wp$}{wp} elliptic functions}\label{sec:mode-power}

In this section we give analytic solutions for modal power.
The fundamental Weierstrass elliptic function theory used in this and subsequent sections can be found in \cite{whittakerCourseModernAnalysis2021}. 
In order to obtain elliptic function solutions in wave mixing dynamics, the key observation is that the derivative of the modal power in \eqref{eq:duv_j} is proportional to the difference of the two wave mixing product terms, and that the Hamiltonian in \eqref{eq:ham-uv} contains their sum.
We then note the simple but important identity:
\begin{equation}
\label{eq:prod-id}
\left(\prod\limits_{k=1}^{4} u_k - \prod\limits_{k=1}^{4} v_k\right)^2 - \left(\prod\limits_{k=1}^{4} u_k + \prod\limits_{k=1}^{4} v_k\right)^2 = - 4 \prod\limits_{j=1}^{4} u_j v_j
\end{equation}
which enables us to square \eqref{eq:duv_j} and replace wave mixing terms with phase modulation terms, i.e., monomials of $u_j v_j$.
To proceed in this manner, let us introduce the function $Q$ which represents the phase modulation part of the Hamiltonian:
\begin{align}
Q(u_1(z)v_1(z), \dots, u_4(z)v_4(z)) &= a_0 + \sum_{j=1}^{4} a_{j}\, u_j v_j + \frac{1}{2}\,\sum_{j,k=1}^{4} a_{j,k}\, u_j v_j u_k v_k , \notag  \\
& = \sum_{l=0}^{2}b_l\,\rho\left(z\right)^l \label{eq:Q-uv}
\end{align}

with $a_0=H$, and observe that by squaring \eqref{eq:duv_j} and substituting \eqref{eq:ham-uv}, \eqref{eq:uvj-gam-rho}, \eqref{eq:prod-id}, and \eqref{eq:Q-uv}, we obtain:
\begin{align}
\left(\frac{d}{d z} \rho{\left(z \right)}\right)^{2} &= Q^{2}{\left({\gamma}_{1} - \rho{\left(z \right)}, \dots, {\gamma}_{4}  - \rho{\left(z \right)}\right)} - 4 \prod_{j=1}^{4} \left({\gamma}_{j} - \rho{\left(z \right)}\right), \label{eq:drho-sqrd-1} \\
\left(\frac{d}{d z} \rho{\left(z \right)}\right)^{2} &=  \left(\sum_{l=0}^{2}b_l\,\rho\left(z\right)^l\right)^{2} - 4 \prod_{j=1}^{4} \left({\gamma}_{j} - \rho{\left(z \right)}\right), \label{eq:drho-sqrd-2} \\
\left(\frac{d}{d z} \rho{\left(z \right)}\right)^{2} &= \sum_{l=0}^{4}d_l\,\rho\left(z\right)^l, \label{eq:drho-sqrd-3} \\
\left(\frac{d}{d z} \rho{\left(z \right)}\right)^{2} &= d_4 \prod_{l=1}^{4} \left(\rho\left(z\right) -  \lambda_l\right), \label{eq:drho-sqrd-4}
\end{align}

where $b_l$, and $d_l$ are given in terms of other parameters and initial conditions in Appendices \ref{app:param-def-appendix} and \ref{app:init-conds}, and where $\lambda_l$ are the roots of the quartic polynomial in $\rho(z)$, i.e. $0=\sum_{k=0}^{4}d_k\,\lambda_{l}^k$.
We now transform \eqref{eq:drho-sqrd-4} from quartic to the standard cubic form of the $\wp$ function using the classical trick which can be conceptualised in three steps \cite{whittakerCourseModernAnalysis2021}:
\begin{equation}
\label{eq:wp-4-to-3}
\begin{array}{l rcl}
\text{(shift so RHS is 0 when $q(z)=0$)} 
& \rho(z) &=& q(z) + \lambda_1,\\
\text{(invert to reduce the quartic to a cubic)} 
& s(z) &=& \dfrac{1}{q(z)},\\
\text{(shift and scale to match Weierstrass coefficients)} 
& w(z) &=& C_1 s(z) + C_0.
\end{array}
\end{equation}

After choosing any root, let us say $\lambda_1$, the procedure sketched in \eqref{eq:wp-4-to-3} is implemented in the following single transformation:
\begin{align}
\rho{\left(z \right)} &= {\lambda}_{1} + \frac{d_4}{- 4 w{\left(z \right)} \prod_{l=1}^{3} {\Omega}_{l}  + \frac{d_4}{3} \sum_{l=1}^{3} {\Omega}_{l} }, \label{eq:rho-wp-1} \\
\Omega_l &= \frac{1}{\lambda_{l+1} - \lambda_1}, \notag \\
\left(\frac{d}{d z} w{\left(z \right)}\right)^{2} &= 4\,w{\left(z \right)}^3 - g_2\,w{\left(z \right)} - g_3, \label{eq:dwp} \\
g_{2} &= {d}_{0} {d}_{4} - \frac{{d}_{1} {d}_{3}}{4} + \frac{{d}_{2}^{2}}{12}, \label{eq:g2-d} \\
g_{3} &= \frac{{d}_{0} {d}_{2} {d}_{4}}{6} - \frac{{d}_{0} {d}_{3}^{2}}{16} - \frac{{d}_{1}^{2} {d}_{4}}{16} + \frac{{d}_{1} {d}_{2} {d}_{3}}{48} - \frac{{d}_{2}^{3}}{216} \label{eq:3-d}
\end{align}
where the constants $g_2$ and $g_3$ are known as Weierstrass elliptic invariants. 

Equation \eqref{eq:dwp} defines the Weierstrass elliptic $\wp$ function and the solution is:
\begin{equation}
w(z) = \wp (z - z_0, g_2, g_3)
\end{equation}
where $z_0$ is a constant chosen to match initial conditions. This constant $z_0$, and others that we will now introduce, can be obtained by inverting $\wp$ using an elliptic integral, (e.g. Carlson's symmetric $R_F$ integral). 
As $\wp$ is an even function, it is neccessary to also specify a corresponding condition for the derivative when inverting, i.e., to find $z$ from known $x,y$ we give conditions such as $\wp\left(z\right)=x, \wp'\left(z\right)=y$, where $\wp'$ is the derivative of $\wp$ known as Weierstrass p-prime. 
The points obtained during such an inversion are determined modulo the period lattice of the doubly periodic $\wp$. 
Let us proceed to define the point $z_0$, and introduce the point $z_1$ as the pole of $\rho(z)$, and points $\mu_j$ as zeroes of $u_j(z)v_j(z)$:
\begin{align}
\wp{\left(z_{0}\right)} &= \frac{{d}_{2}}{12} + \frac{{d}_{3} {\lambda}_{1}}{4} + \frac{{d}_{4} {\lambda}_{1}^{2}}{2} + \frac{- {d}_{1} - 2 {d}_{2} {\lambda}_{1} - 3 {d}_{3} {\lambda}_{1}^{2} - 4 {d}_{4} {\lambda}_{1}^{3}}{4 \left(- \rho{\left(0 \right)} + {\lambda}_{1}\right)}, \notag \\
\wp'{\left(z_{0}\right)} &= \frac{\left({d}_{1} + 2 {d}_{2} {\lambda}_{1} + 3 {d}_{3} {\lambda}_{1}^{2} + 4 {d}_{4} {\lambda}_{1}^{3}\right) }{4 \left(\rho{\left(0 \right)} - {\lambda}_{1}\right)^{2}}\left. \frac{d}{d z} \rho{\left(z \right)} \right|_{\substack{ z=0 }}, \notag \\
\wp{\left(z_{1}\right)} &= \frac{{d}_{2}}{12} + \frac{{d}_{3} {\lambda}_{1}}{4} + \frac{{d}_{4} {\lambda}_{1}^{2}}{2}, \notag \\
\wp'{\left(z_{1}\right)} &= \frac{\left(- {d}_{1} - 2 {d}_{2} {\lambda}_{1} - 3 {d}_{3} {\lambda}_{1}^{2} - 4 {d}_{4} {\lambda}_{1}^{3}\right) \sqrt{{d}_{4}}}{4}, \notag \\
\wp{\left({\mu}_{j} - z_{0}\right)} &= \frac{{d}_{2}}{12} + \frac{{d}_{3} {\lambda}_{1}}{4} + \frac{{d}_{4} {\lambda}_{1}^{2}}{2} - \frac{- {d}_{1} - 2 {d}_{2} {\lambda}_{1} - 3 {d}_{3} {\lambda}_{1}^{2} - 4 {d}_{4} {\lambda}_{1}^{3}}{4 \left({\gamma}_{j} - {\lambda}_{1}\right)}, \notag \\
\wp'{\left({\mu}_{j}- z_{0}\right)} &= - \frac{\left({b}_{0} + {b}_{1} {\gamma}_{j} + {b}_{2} {\gamma}_{j}^{2}\right) \left({d}_{1} + 2 {d}_{2} {\lambda}_{1} + 3 {d}_{3} {\lambda}_{1}^{2} + 4 {d}_{4} {\lambda}_{1}^{3}\right)}{4 \left({\gamma}_{j} - {\lambda}_{1}\right)^{2}}. \label{eq:wp-points}
\end{align}

The solutions for modal powers are then found from \eqref{eq:uvj-gam-rho} and \eqref{eq:rho-wp-1} to be:
\begin{align}
u_j{\left(z\right)} v_j{\left(z\right)} &= \rho(\mu_j) - \rho(z), \notag \\
&= \frac{\wp'{\left(z_{1}\right)}}{ \sqrt{{d}_{4}} \left(\wp{\left(z_{1}\right)} - \wp{\left({\mu}_{j} - z_{0}\right)}\right)} - \frac{\wp'{\left(z_{1}\right)}}{\sqrt{{d}_{4}} \left(\wp{\left(z_{1}\right)} - \wp{\left(z - z_{0}\right)}\right) }, \notag \\
&= \frac{\wp'{\left(z_{1}\right)} }{ \sqrt{{d}_{4}} \left(\wp{\left(z_{1}\right)} - \wp{\left({\mu}_{j}- z_{0}\right)}\right)} \frac{ \left(\wp{\left(z - z_{0}\right)} - \wp{\left({\mu}_{j} - z_{0}\right)}\right) }{ \left(\wp{\left(z - z_{0}\right)} - \wp{\left(z_{1}\right)}\right) } \label{eq:uv-wp}
\end{align}


% ---------- SECTION -------------
% --------------------------------

\section{Solutions for modes in terms of Weierstrass \texorpdfstring{$\sigma$}{sigma}, \texorpdfstring{$\zeta$}{zeta} functions}

Through substitution of \eqref{eq:ham-uv}, \eqref{eq:duv_j}, \eqref{eq:uvj-gam-rho}, and \eqref{eq:power-conserved} into \eqref{eq:uv-system}, it can be shown that \eqref{eq:uv-system} can be written in terms of logarithmic derivatives such that the right hand side is a function of $\rho$ and its derivative $\rho'$ in the form:
\begin{align}
\frac{\frac{\partial}{\partial z} u_j{\left(z\right)}}{u_j{\left(z\right)}} &= \frac{1}{2}\frac{\rho'{\left(z \right)} - \rho'{\left({\mu}_{j} \right)}}{\rho{\left(z \right)} - \rho{\left({\mu}_{j} \right)}} + \rho{\left(z \right)} {\Lambda}_{1,j} + {\Lambda}_{0,j}, \notag \\
\frac{\frac{\partial}{\partial z} v_j{\left(z\right)}}{v_j{\left(z\right)}} &= \frac{1}{2}\frac{\rho'{\left(z \right)} + \rho'{\left({\mu}_{j} \right)}}{\rho{\left(z \right)} - \rho{\left({\mu}_{j} \right)}} - \rho{\left(z \right)} {\Lambda}_{1,j} - {\Lambda}_{0,j}, \label{eq:dlog-u-v-rho} \\
{\Lambda}_{0,j} &= - {a}_{j} - \frac{{\gamma}_{j}}{4} \sum\limits_{k,l=1}^{4} {a}_{k,l} - \sum_{k=1}^{4} {a}_{j,k} {\gamma}_{k} + \frac{1}{2}\sum_{k=1}^{4} {\gamma}_{k} \sum_{l=1}^{4} {a}_{k,l} + \frac{1}{2}\sum_{k=1}^{4} {a}_{k}, \\
{\Lambda}_{1,j} &= \sum_{k=1}^{4} {a}_{j,k} - \frac{1}{4}\sum\limits_{k,l=1}^{4}  {a}_{k,l}.
\end{align}

We substitute \eqref{eq:uv-wp} into \eqref{eq:dlog-u-v-rho} and use the elliptic function identity:
\begin{equation}
\frac{\wp'{\left(x,g_{2},g_{3} \right)}}{\wp{\left(x,g_{2},g_{3} \right)} - \wp{\left(y,g_{2},g_{3} \right)}} = \zeta{\left(x + y,g_{2},g_{3} \right)} + \zeta{\left(x - y,g_{2},g_{3} \right)} - 2 \zeta{\left(x,g_{2},g_{3} \right)}
\end{equation}
to write the right hand side in terms of $\zeta$ and constants:
\begin{align}
\frac{\frac{\partial}{\partial z} u{\left(z,{\mu}_{j} \right)}}{u{\left(z,{\mu}_{j} \right)}} =& \frac{\left(\zeta{\left(z - z_{0} + z_{1} \right)} - 2 \zeta{\left(z_{1} \right)} - \zeta{\left(z - z_{0} - z_{1} \right)}\right) {\Lambda}_{1,j}}{\sqrt{{d}_{4}}} \nonumber \\[6pt]
& + \zeta{\left(z - 2 z_{0} + {\mu}_{j} \right)} - \frac{\zeta{\left(z - z_{0} - z_{1} \right)}}{2} - \frac{\zeta{\left(z - z_{0} + z_{1} \right)}}{2} \nonumber \\[6pt]
& - \frac{\zeta{\left({\mu}_{j} - z_{0} - z_{1}\right)}}{2} - \frac{\zeta{\left({\mu}_{j} - z_{0} + z_{1}\right)}}{2} + {\Lambda}_{0,j} + {\Lambda}_{1,j} {\lambda}_{1} \notag \\[12pt]
\frac{\frac{\partial}{\partial z} v{\left(z,{\mu}_{j} \right)}}{v{\left(z,{\mu}_{j} \right)}} =& - \frac{\left(\zeta{\left(z - z_{0} + z_{1} \right)} - 2 \zeta{\left(z_{1} \right)} - \zeta{\left(z - z_{0} - z_{1} \right)}\right) {\Lambda}_{1,j}}{\sqrt{{d}_{4}}} \nonumber \\[6pt]
& + \zeta{\left(z - {\mu}_{j} \right)} - \frac{\zeta{\left(z - z_{0} - z_{1} \right)}}{2} - \frac{\zeta{\left(z - z_{0} + z_{1} \right)}}{2} \nonumber \\[6pt]
& + \frac{\zeta{\left({\mu}_{j} - z_{0} - z_{1}\right)}}{2} + \frac{\zeta{\left({\mu}_{j} - z_{0} + z_{1} \right)}}{2} - {\Lambda}_{0,j} - {\Lambda}_{1,j} {\lambda}_{1} \label{eq:dlog-u-v-zeta}
\end{align}

Equations \eqref{eq:dlog-u-v-zeta} can be integrated by noting that the Weierstrass $\zeta$ function is the logarithmic derivative of the $\sigma$ function:
\begin{equation}
\label{eq:zeta-dlog_sigma}
\zeta\left(z, g_2, g_3\right)=\frac{\partial}{\partial z} \sigma\left(z, g_2, g_3\right).
\end{equation}

Performing the integration and taking exponentials gives the first main result of this paper, the solutions for modes $u_j, v_j$:
\begin{align}
u_j{\left(z\right)} &= \frac{\alpha_j\,\sqrt{W_j} \,\sigma{\left(z - 2 z_{0} + {\mu}_{j} \right)} \exp\left(z {r}_{0,j} + \log{\left(\frac{\sigma{\left(z - z_{0} + z_{1} \right)}}{\sigma{\left(z - z_{0} - z_{1} \right)}} \right)} {r}_{1,j}\right)}{\sqrt{\wp{\left(z_{1} \right)} - \wp{\left(z - z_{0} \right)}} \sigma{\left({\mu}_{j} - z_{0}\right)} \sigma{\left(z - z_{0} \right)}}, \notag \\[12pt]
v_j{\left(z\right)} &= \frac{\sqrt{W_j} \, \sigma{\left(z - {\mu}_{j} \right)} \exp\left(- z {r}_{0,j} - \log{\left(\frac{\sigma{\left(z - z_{0} + z_{1} \right)}}{\sigma{\left(z - z_{0} - z_{1} \right)}} \right)} {r}_{1,j} \right)}{\alpha_j\,\sqrt{\wp{\left(z_{1} \right)} - \wp{\left(z - z_{0} \right)}} \sigma{\left({\mu}_{j} - z_{0}\right)} \sigma{\left(z - z_{0} \right)}} \label{eq:u-v-quartic}
\end{align}

where the branch of the logarithm is chosen continuously along the integration path from $z=0$, $\alpha_j$ is the integration constant that can be fixed by initial conditions to capture any phase offset between a mode and its conjugate, and where the other constants are:
\begin{align}
W_j &= \frac{\wp'{\left(z_{1} \right)}}{\sqrt{{d}_{4}}\,\left(\wp{\left(z_{1} \right)} - \wp{\left({\mu}_{j} - z_{0}\right)}\right)}, \\[6pt]
r_{0,j} &= {\Lambda}_{0,j} + {\Lambda}_{1,j} {\lambda}_{1} - \frac{2 \zeta{\left(z_{1} \right)} {\Lambda}_{1,j}}{\sqrt{{d}_{4}}} - \frac{\zeta{\left({\mu}_{j} - z_{0} - z_{1}\right)}}{2} - \frac{\zeta{\left({\mu}_{j} - z_{0} + z_{1}\right)}}{2}, \\[6pt]
r_{1,j} &= \frac{{\Lambda}_{1,j}}{\sqrt{{d}_{4}}}.
\end{align}
Having obtained these solutions we show in Appendix-\ref{app:fs-det-ham-proof} that \eqref{eq:ham-uv} is the Frobenius-Stickelberger determinant.

% ---------- SECTION -------------
% --------------------------------

\section{When quartic terms cancel to leave a cubic}

In this section we tackle a special case in which things simplify. 
There will be no $\rho(z)^4$ term in the differential equation when $d_4=0$. 
For $d_4=0$, we require $b_2 \pm 2$, which is a parameter requirement, i.e., it cannot be achieved in general through tailored initial conditions of the modes.
This case is simpler to solve in some ways but it is not easily obtained by taking the limit $d_4\rightarrow0$. 
When $d_4=0$, we get $\wp'(z_1)=0$, i.e., $z_1$ is congruent to a half-period of the elliptic function, commonly denoted $\omega_i$, for $i=1,2,3$. 
It can then be shown either by solving the differential equation starting from the cubic, or by applying elliptic function identities to intermediate results in the quartic derivation,
that the solutions for modes simplify to:

\begin{align}
u_j{\left(z\right)} &= \frac{\alpha_j\, 2 \sigma{\left(z - 2 z_{0} + 2 z_{1} + {\mu}_{j}\right)} \exp\left( z \left( {\Lambda}_{0,j} + \frac{{d}_{2}}{3 {d}_{3}} {\Lambda}_{1,j} -\zeta{\left({\mu}_{j} -z_{0} + z_{1}\right)}\right) \right)}{ \sqrt{{d}_{3}}\, \sigma{\left({\mu}_{j} - z_{0} + z_{1}\right)} \sigma{\left(z - z_{0} + z_{1}\right)}}, \notag \\[12pt]
v_j{\left(z\right)} &= \frac{2 \sigma{\left(z - {\mu}_{j}\right)} \exp\left( - z \left({\Lambda}_{0,j} + \frac{{d}_{2}}{3 {d}_{3}}{\Lambda}_{1,j}  -\zeta{\left({\mu}_{j} -z_{0} + z_{1}\right)}\right) \right)}{ \alpha_j\, \sqrt{{d}_{3}}\, \sigma{\left({\mu}_{j} - z_{0} + z_{1}\right)} \sigma{\left(z - z_{0} + z_{1}\right)}} \label{eq:u-v-cubic}
\end{align}
where the integration constant $\alpha_j$ is to be determined by initial conditions using \eqref{eq:u-v-cubic} and is therefore not the same $\alpha_j$ as in \eqref{eq:u-v-quartic}, but where all other parameters retain their prior definitions.
The modal power simplies to:
\begin{equation}
\label{eq:modal-power-cubic}
u_j{\left(z\right)} v_j{\left(z\right)} = \frac{4 \wp{\left({\mu}_{j} - z_{0} + z_{1}\right)}}{{d}_{3}} - \frac{4 \wp{\left(z - z_{0} + z_{1}\right)}}{{d}_{3}}
\end{equation}
It is to be noted that this is a special case in which paramters take on particular values in this system. 
It should not be confused with the subsequent case in coming sections where we show a general nonlinear transform is always possible to remove the quartic term.

% ---------- SECTION -------------
% --------------------------------

\section{Transforming to canonical coordinates}

In this section we will demonstrate an application of the analytic solution by showing how its form guides us towards a canonical coordinate system for the analysis of four-wave mixing.
In the canonical coordinates the system is simplified in the following ways:
\begin{itemize}
    \item there is no cross-phase modulation XPM 
    \item differential equations for modal powers involve cubic not quartic polynomials
    \item system parameters are greatly reduced and if desired completely removable
    \item solutions are single-valued meromorphic Kronecker theta functions.                                                                                                                      
\end{itemize}
The transformations preserve the following:
\begin{itemize}
    \item conservation of the Hamiltonian and intermodal power laws
    \item intermodal power ratios
    \item the cross-ratio between any four distinct modal powers
    \item differential equation structure in regards to recognisable four-wave mixing terms.                                                                                                                      
\end{itemize}

\subsection{Removing cross-phase modulation with a gauge transform}

To begin, let us consider a transform of the system in \eqref{eq:uv-system} of the following form:

\begin{align}
u_j(z) &= \hat{u}_j(z) e^{- \phi_j(z)} \notag \\
v_j(z) &= \hat{v}_j(z) e^{\phi_j(z)} \\ 
\sum_{j=1}^{4} \phi_j(z) &= 0
\end{align}

where transforming the conjugate mode with the opposing phase leaves modal powers unchanged, and where the sum over $\phi_j$ being zero ensures we do not encounter any new terms appearing in the exponents of wave mixing terms.
We make the following choice for $\phi_j$ composed of a linear part ($L$) and a nonlinear part ($NL$) (where $L$ and $NL$ are function labels not exponents):

\begin{align}
\phi_j(z) &= \phi_j^{L}(z) + \phi_j^{NL}(z) \\
\phi_j^{L}(z) &= z\left({a}_{j} - \frac{1}{4}\sum_{m=1}^{4} a_{m} - \frac{{\gamma}_{j}}{4} \sum\limits_{l,k=1}^{4} a_{l,k}\right) \\
\phi_j^{NL}(z)  &= \sum_{k=1}^{4} \left({a}_{j,k} - \frac{1}{4}\sum_{l=1}^{4} {a}_{l,k}\right) \int \hat{u}_k (z) \hat{v}_k (z) \, dz \\
\sum_{j=1}^{4} \phi_j(z) &= \sum_{j=1}^{4} \phi_j^{L}(z) = \sum_{j=1}^{4} \phi_j^{NL}(z) =0.
\end{align}

This transforms \eqref{eq:uv-system} into the following system:
\begin{align}
\frac{\partial}{\partial z} \hat{u}_j &= \left(\frac{b_1}{4} - \frac{b_2}{2}\hat{u}_j \hat{v}_j \right) \hat{u}_j + \prod\limits_{k=1, k \ne j}^{4} \hat{v}_k \notag \\
\frac{\partial}{\partial z} \hat{v}_j &= \left( - \frac{b_1}{4} + \frac{b_2}{2}\hat{u}_j \hat{v}_j\right) \hat{v}_j - \prod\limits_{k=1, k \ne j}^{4} \hat{u}_k \label{eq:uv-hat-system}
\end{align}

for which the conserved canonical Hamiltonian is:
\begin{align}
\hat{H} &= \prod_{l=1}^{4} \hat{u}_l + \prod_{l=1}^{4} \hat{v}_l - \frac{1}{4}\sum_{l=1}^{4} \left(b_2 \hat{u}^{2}_l \hat{v}^{2}_l  - b_1 \hat{u}_l \hat{v}_l \right)
\end{align}
and the intermodal power conservation laws are unchanged such that $\hat{u}_j \hat{v}_j - \hat{u}_k \hat{v}_k = \gamma_j - \gamma_k$.
In comparison to \eqref{eq:uv-system}, we see that in \eqref{eq:uv-hat-system} we now have a single propagation constant for all modes $b_1/4$, a single self-phase modulation coefficient $b_2/2$, and no cross-phase modulation terms.
In terms of the solutions to the system, the effect of the $\phi_j^{NL}$ transform is to remove the $z$ dependent log terms weighted by $r_{1,j}$ in \eqref{eq:u-v-quartic}. 

\subsection{Reducing the quartic to a cubic via local normalisation}\label{subsec:bar-coords}

Next, we show how we can perform a coordinate transformation that involves a local, i.e. $z$ dependent, normalisation of the modes themselves, which at the same time induces a Mobius transform on modal powers. 
This transform implements the classic trick that reduces the quartic to the cubic discussed in Section~\ref{sec:mode-power}. However, here the effect is delivered at the level of modes $u_j, v_j$ not only at the mode power level $u_j v_j$, thus we can observe a corresponding change to the coupled system.
When we do this, we will see that it further reduces the number of parameters in the system such that the propagation constant becomes the reciprocal of the SPM coefficient.

Let us define the local normalisation function $h(z)$ and its associated coordinate transform $\left(\hat{u}_j, \hat{v}_j\right) \rightarrow \left(\bar{u}_j, \bar{v}_j \right)$ (note the hat to bar change in notation):
\begin{align}
\hat{u}_j(z) &= 2 \sqrt{{\lambda}_{1} \left({\gamma}_{j} - {\lambda}_{1}\right)} \frac{\bar{u}_j(z) e^{-\theta_j z}}{\sqrt{h{\left(z \right)}}} \notag \\
\hat{v}_j(z) &= 2 \sqrt{{\lambda}_{1} \left({\gamma}_{j} - {\lambda}_{1}\right)}  \frac{\bar{v}_j(z) e^{\theta_j z} }{\sqrt{h{\left(z \right)}}} \notag \\
h{\left(z \right)} &= {d}_{5} - \sum_{l=1}^{4} \left({\gamma}_{l} - {\lambda}_{1}\right) \bar{u}_l \bar{v}_l = 4 {\lambda}_{1} \bar{u}_j \bar{v}_j - \frac{{\lambda}_{1}{d}_{5} }{{\gamma}_{j} - {\lambda}_{1}} \label{eq:hat-to-bar}
\end{align}
where $\theta_j$ and $d_5$ are given in Appendix \ref{app:bar-coords-params}. 
The $\theta_j$ parameter is not involved in the reduction of the quartic to the cubic but its inclusion keeps the propagation constant the same for all modes after the transform.
The key parameter in the transformation is the root $\lambda_1$ previously defined in Section \ref{sec:mode-power} for the purpose of quartic to cubic reduction.

The transformation in \eqref{eq:hat-to-bar} sends \eqref{eq:uv-hat-system} to:
\begin{align}
\frac{\partial}{\partial z} \bar{u}_j &= -\left(\frac{1}{\chi} - \frac{\chi}{4}\bar{u}_j \bar{v}_j \right) \bar{u}_j - \frac{\varsigma \chi}{4} \prod\limits_{k=1, k \ne j}^{4} \bar{v}_k, \notag \\
\frac{\partial}{\partial z} \bar{v}_j &= \left( \frac{1}{\chi} - \frac{\chi}{4}\bar{u}_j \bar{v}_j\right) \bar{v}_j + \frac{\varsigma \chi}{4} \prod\limits_{k=1, k \ne j}^{4} \bar{u}_k \label{eq:uv-bar-system}
\end{align}

for which the conserved canonical Hamiltonian and intermodal power conservation laws are:
\begin{align}
\bar{H} &= \sum_{l=1}^{4} \left(\frac{\chi}{8} \bar{u}^{2}_l \bar{v}^{2}_l  - \frac{1}{\chi}  \bar{u}_l \bar{v}_l \right) - \frac{\varsigma \chi}{4} \left(\prod_{l=1}^{4} \bar{u}_l + \prod_{l=1}^{4} \bar{v}_l\right), \notag \\
\bar{\gamma}_j - \bar{\gamma}_k &= \bar{u}_j \bar{v}_j - \bar{u}_k \bar{v}_k,
\end{align}
with $\varsigma \pm 1$, $\chi$ and $\bar{\gamma}_j$ given in Appendix \ref{app:bar-coords-params}.
The modal power in these coordinates evolves according to:
\begin{equation}
\label{eq:duv_bar_j} 
\frac{d}{d z} \bar{u}_j \bar{v}_j = -\frac{\varsigma \chi}{4}\left(\prod\limits_{k=1}^{4} \bar{u}_k - \prod\limits_{k=1}^{4} \bar{v}_k\right)
\end{equation}

Remarkably, the terms in \eqref{eq:hat-to-bar} are the same as those in \eqref{eq:uv-hat-system} only with different coefficients. 
We thus say that the system is invariant under the transformation, which is quite suprising given the $z$ dependence of the normalisation.
Similarly, by comparing \eqref{eq:duv_bar_j} to \eqref{eq:duv_j} we see that \eqref{eq:duv_j} is invariant up to a constant factor.

To solve this system, we may define the function $\bar{w}(z)$ in terms of $h$ by:
\begin{align}
h{\left(z \right)} = \frac{\left({d}_{2} + 3 {d}_{3} {\lambda}_{1} + 6 {d}_{4} {\lambda}_{1}^{2}\right) {\lambda}_{1}}{3} - 4 \bar{w}{\left(z \right)} {\lambda}_{1}
\end{align}

and we find then that:
\begin{align}
\left(\frac{d}{d z} \bar{w}{\left(z \right)}\right)^{2} &= 4\,\bar{w}{\left(z \right)}^3 - g_2\,\bar{w}{\left(z \right)} - g_3, \notag \\
\bar{w}(z) &= \wp (z - z_0) \label{eq:dwp-bar} \\
h(z) &= 4\lambda_1\left(\wp (z_1) - \wp (z - z_0)\right) \label{eq:dwp-h-bar} \\
\bar{u}_j(z)\bar{v}_j(z) &= \wp(\mu_j - z_0) - \wp(z - z_0)
\end{align}
where $z_0$, $z_1$, $\mu_j$, $g_2$, and $g_3$ retain their previous definitions from the original coordinates. 
We see that as a result of the transformation in \eqref{eq:hat-to-bar}, the right hand side of \eqref{eq:dwp-bar} is cubic in $\bar{w}$ and thus the corresponding differential equations for $h$ and $\bar{u}_j\bar{v}_j$ inherit this simplification as they are linearly related.
The elliptic function form of $h(z)$ is not a surprise as it was purposely constructed in the transformation so as to remove the corresponding term from the denominator in \eqref{eq:u-v-quartic}.

The solutions for modes $\bar{u}_j, \bar{v}_j$ are:
\begin{align}
\bar{u}_j(z) &= \frac{\bar{\alpha}_{j} \sigma{\left(z - 2 z_{0} + {\mu}_{j}\right)} \exp{\left( z \bar{\kappa}_j\right)} }{\sigma{\left(z - z_{0}\right)} \sigma{\left({\mu}_{j} - z_{0}\right)}} \notag \\
\bar{v}_j(z) &= \frac{\sigma{\left(z - {\mu}_{j}\right)} \exp{\left(- z \bar{\kappa}_j\right)}}{\bar{\alpha}_{j} \sigma{\left(z - z_{0}\right)} \sigma{\left({\mu}_{j} - z_{0}\right)} } \label{eq:u-v-bar}
\end{align}
where the Weierstrass $\sigma$ functions use the same $g_2,g_3$ from the original coordinates, 
$\bar{\kappa}_j$ is given in Appendix \ref{app:param-def-appendix}, and $\bar{\alpha}_j$ is an integration constant fixed by initial conditions and used to capture any relative phase offset between a mode $\bar{u}_j$ and its conjugate $\bar{v}_j$.

\subsection{A parameterless system via rescaling}\label{subsec:tilde-coords}

It is now simple to remove the remaining parameter via a scaling of the modes and the length variable as follows (note the bar to tilde notation change):
\begin{align}
\bar{u}_j(z) &= \frac{\varsigma \sqrt[4]{\varsigma}}{\chi}\tilde{u}_j(\xi), \notag \\
\bar{v}_j(z) &= \frac{\varsigma }{\sqrt[4]{\varsigma}\,\chi}\tilde{v}_j(\xi), \notag \\
z &= \chi\xi
\end{align}
This substitution transforms \eqref{eq:uv-bar-system} to:
\begin{align}
\frac{\partial}{\partial \xi} \tilde{u}_j &= -\left(1 - \frac{\tilde{u}_j \tilde{v}_j}{4} \right) \tilde{u}_j - \frac{1}{4}\prod\limits_{k=1, k \ne j}^{4} \tilde{v}_k, \notag \\
\frac{\partial}{\partial \xi} \tilde{v}_j &= \left( 1 - \frac{\tilde{u}_j \tilde{v}_j}{4}\right) \tilde{v}_j + \frac{1}{4}\prod\limits_{k=1, k \ne j}^{4} \tilde{u}_k, \label{eq:uv-tilde-system}
\end{align}

for which the conserved canonical Hamiltonian is:
\begin{align}
\tilde{H} &= \sum_{l=1}^{4} \left(\frac{1}{8} \tilde{u}^{2}_l \tilde{v}^{2}_l  - \tilde{u}_l \tilde{v}_l \right) - \frac{1}{4}\left(\prod_{l=1}^{4} \tilde{u}_l + \prod_{l=1}^{4} \tilde{v}_l\right), \label{eq:H-tilde}
\end{align}

and the solutions are:
\begin{align}
\tilde{u}_j{\left(\xi\right)} &= \frac{\tilde{\epsilon}_{j} \,\sigma{\left(\xi - 2 \xi_{0} + {\tilde{\mu}}_{j}\right)} \exp\left({\xi \left( 1 + \frac{{\tilde{\gamma}}_{j}}{2} - \zeta{\left( {\tilde{\mu}}_{j} - \xi_{0}\right)}\right)}\right)}{\sigma{\left(\xi - \xi_{0}\right)} \sigma{\left( {\tilde{\mu}}_{j} - \xi_{0}\right)}}, \notag \\
\tilde{v}_j{\left(\xi\right)} &= \frac{ \sigma{\left(\xi - {\tilde{\mu}}_{j}\right)} \exp\left({-\xi \left( 1 + \frac{{\tilde{\gamma}}_{j}}{2} - \zeta{\left( {\tilde{\mu}}_{j} - \xi_{0}\right)}\right)}\right)}{\tilde{\epsilon}_{j} \,\sigma{\left(\xi - \xi_{0}\right)} \sigma{\left( {\tilde{\mu}}_{j} - \xi_{0}\right)}}  \label{eq:u-v-tilde}
\end{align}
where the $\sigma$ and $\zeta$ functions use the scaled invariants $\tilde{g}_2$ and $\tilde{g}_3$ given in Appendix \ref{app:scaled-params} together with $\xi_0$, $\tilde{\epsilon}_j$, $\tilde{\mu}_j$ and $\tilde{\gamma}_j$.
The solutions in \eqref{eq:u-v-bar} and \eqref{eq:u-v-tilde} are, up to constant and $z$ dependent exponential factors, Kronecker theta functions, which simply put are a ratio of two Weierstrass $\sigma$ functions shifted relative to each other in their argument.
The functions are associated with Kronecker after he gave a Fourier series \cite{whittakerCourseModernAnalysis2021} and multipole expansion \cite{weilEllipticFunctionsAccording1976, charolloisEllipticFunctionsAccording2016} for the function, both of which may prove useful in nonlinear optics analysis.
The form of solutions herein is similar to that obtained in other nonlinear optical systems such as two and three wave mixing in quadratic nonlinear media, polarisation dynamics in nonlinear fibers, and parity-time symmetric nonlinear couplers \cite{heskethGeneralComplexEnvelope2015}. 
The exponentials and $\sigma$ functions are entire functions and this ratio is a single valued meromorphic function, unlike the solutions in \eqref{eq:u-v-quartic}. 
The solutions are quasi-periodic and modulo the lattice they have zeros where the argument of $\sigma$ vanishes in the numerator, and poles where the argument of $\sigma$ vanishes in the denominator. 
Owing to the parameterless form of \eqref{eq:uv-tilde-system} and the simpler form of the solutions in \eqref{eq:u-v-tilde}, we refer to $\tilde{u}_j, \tilde{v}_j$ as the canonical coordinates of four-wave mixing and their derivation is our second main result.


% ---------- SECTION -------------
% --------------------------------

\section{Plotting analytic vs numeric solutions}

In this last section we check the validity of the solutions by evaluating them numerically. 
We simultaneously demonstrate numerical evaluation is possible using open source software in Python. 
We evaluate analytic solutions numerically using the \emph{pyweierstrass} Python package \cite{laurentPyweierstrass2022} which provide Weierstrass elliptic functions as a wrapper around Jacobi elliptic functions from the \emph{mpmath} Python package \cite{MpmathPythonLibrary2023}. 
We plot them against numeric solutions of the corresponding differential equations found using the DOP853 Runge-Kutta algorithm from \emph{SciPy} in Python \cite{virtanenSciPy10Fundamental2020}.

In Figures \ref{fig:u-v-re} and \ref{fig:u-v-im} we plot the real and imaginary parts, respectively, of the product of $u_jv_j$ in a non-physical $u,v$ scenario using Equation~\eqref{eq:uv-wp}.
The analytic dashed lines are shown to be in agreement with the numeric solutions shown as symbols.
The lines in the plot evolve in unison owing to the intermodal power conservation laws in \eqref{eq:power-conserved}.

In Figures \ref{fig:A-abs} and \ref{fig:A-phi} we plot the absolute value squared and phase, respectively, of $A_j$ in a physical four-wave mixing case.
The value of $A_j$ was found using \eqref{eq:u-v-quartic} to first obtain $u_j, v_j$, before converting to $A_j, A_j^{*}$ using \eqref{eq:u-v-A}.
The analytic dashed lines are shown to be in agreement with the numeric solutions shown as symbols. 
As expected in nonlinear fiber optic four-wave mixing, periodic intermodal power exchange is seen between modes in Figure \ref{fig:A-abs}, 
while the phase plot in Figure \ref{fig:A-phi} is dominated by linear propagation constant effects with some nonlinear effects visible as areas of high curvature in the plotted lines.

\begin{figure}[H]
\centering
\includegraphics[width=1.0\textwidth]{plots/case1_plot_1.pdf}
\caption{Real part of analytic Equation~\eqref{eq:uv-wp} against numeric solutions.}
\label{fig:u-v-re}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width=1.0\textwidth]{plots/case1_plot_2.pdf}
\caption{Imaginary part of analytic Equation~\eqref{eq:uv-wp} against numeric solutions.}
\label{fig:u-v-im}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width=1.0\textwidth]{plots/case2_plot_1.pdf}
\caption{$\left|A_j\right|^2$ using analytic Equation~\eqref{eq:u-v-quartic} in \eqref{eq:u-v-A} against numeric solutions.}
\label{fig:A-abs}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width=1.0\textwidth]{plots/case2_plot_2.pdf}
\caption{Phase $\phi_j$ using analytic Equation~\eqref{eq:u-v-quartic} in \eqref{eq:u-v-A} against numeric solutions.}
\label{fig:A-phi}
\end{figure}


\section{Conclusion}
We have derived a complete analytic solution of the quasi-continuous-wave four-wave mixing system. 
These solutions are expressed in terms of Weierstrass elliptic functions, and we have demonstrated how they can be evaluated numerically using open-source Python code.

Motivated by the structure of these analytic solutions, we investigated a class of coordinate transformations that yield a canonical coordinate system in which the governing differential equations simplify substantially. 
Through this analysis, we showed that the full four-wave mixing system can be reduced to a significantly simpler, parameter-free system. 
Remarkably, the structural form of the differential equations is preserved under these transformations, despite the fact that the transformations themselves depend explicitly on the independent variable $z$. 
In the canonical coordinates, the solutions become single-valued, meromorphic Kronecker theta functions.

Four-wave mixing provides an important and challenging test case for mathematical analysis and is arguably among the more intricate examples of dynamical systems admitting elliptic (genus-one) function solutions, owing to the presence of quartic polynomials. 
In this work, we have shown in detail how these difficulties can be systematically addressed. 
The methods developed here may be transferable to the analysis of related nonlinear systems, such as the interaction of modes in multimode nonlinear fiber optics (see, e.g., Chapter 4 in \cite{heskethNonlinearEffectsMultimode2014}).

In forthcoming work, we intend to present a unified framework for integrable nonlinear coupled ordinary differential equations with elliptic and hyperelliptic function solutions, in which the four-wave mixing system studied here will serve as a central example.

\section*{Acknowledgements}
The author thanks Maria Dimou for a careful read of the manuscript.

\appendix


% ---------- APPENDIX ------------
% --------------------------------

\section{Parameter definitions in the original coordinates}
\label{app:param-def-appendix}

\begin{align}
{b}_{0} &= {a}_{0} + \sum_{j=1}^{4} {a}_{j} {\gamma}_{j} + \frac{1}{2}\sum\limits_{j,k=1}^{4} {a}_{j,k} {\gamma}_{j} {\gamma}_{k}, \notag \\
{b}_{1} &= - \sum_{j=1}^{4} {a}_{j} - \frac{1}{2}\sum\limits_{j,k=1}^{4} \left({\gamma}_{j} + {\gamma}_{k}\right) {a}_{j,k}, \notag \\
{b}_{2} &= \frac{1}{2}\sum\limits_{j,k=1}^{4} {a}_{j,k}, \notag \\
{c}_{0} &= \prod_{j=1}^{4} {\gamma}_{j}, \notag \\
{c}_{1} &= - \sum_{k=1}^{4} \prod_{\substack{j=1 \\ j \ne k}}^{4} {\gamma}_{j}, \notag \\
{c}_{2} &= \frac{3}{2} \sum_{j=1}^{4} {\gamma}_{j}^{2} - \frac{1}{4}\sum\limits_{j,k=1}^{4} \left({\gamma}_{j} - {\gamma}_{k}\right)^{2} = - \frac{1}{2}\sum_{j=1}^{4} {\gamma}_{j}^{2}, \notag \\
{c}_{3} &= 0, \notag \\
{c}_{4} &= 1, \notag \\
{d}_{0} &= {b}_{0}^{2} - 4 {c}_{0}, \notag \\
{d}_{1} &= 2 {b}_{0} {b}_{1} - 4 {c}_{1}, \notag \\
{d}_{2} &= 2 {b}_{0} {b}_{2} + {b}_{1}^{2} - 4 {c}_{2}, \notag \\
{d}_{3} &= 2 {b}_{1} {b}_{2} - 4 {c}_{3}, \notag \\
{d}_{3} &= 2 {b}_{1} {b}_{2} - 4 {c}_{3}, \notag \\
{d}_{4} &= {b}_{2}^{2} - 4 {c}_{4} 
\end{align}

% ---------- APPENDIX ------------
% --------------------------------

\section{Initial condition relations}
\label{app:init-conds}

\begin{align}
\rho{\left(0 \right)} &= - \frac{1}{4}\sum_{j=1}^{4} u_j{\left(0 \right)} v_j{\left(0 \right)}, \notag \\
{\gamma}_{j} &= u_j{\left(0\right)} v_j{\left(0 \right)} - \frac{1}{4}\sum_{j=1}^{4} u_j{\left(0\right)} v_j{\left(0\right)}, \notag \\
\left. \frac{d}{d z} \rho{\left(z \right)} \right|_{\substack{ z=0 }} &= \prod_{j=1}^{4} u_j(0) - \prod_{j=1}^{4} v_j(0)
\end{align}


% ---------- APPENDIX ------------
% --------------------------------

\section{The Frobenius-Stickelberger determinant}
\label{app:fs-det-ham-proof}

The Frobenius-Stickelberger (FS) determinant formula is an elliptic function identity that relates products of $\sigma$ functions to a multivariate determinant of higher order derivatives of $\wp$ \cite{frobeniusZurTheorieElliptischen1877, whittakerCourseModernAnalysis2021}.
In this section we show that the conservation of the Hamiltonian can be viewed as a manifestation of FS.
We are interested in the $4\times4$ case of FS in the form:
\begin{align}
\label{eq:fs-det-m}
\frac{C\,\sigma{\left(z + {\nu}_{1}\right)} \sigma{\left(z + {\nu}_{2}\right)} \sigma{\left(z + {\nu}_{3}\right)} \sigma{\left(z - {\nu}_{1} - {\nu}_{2} - {\nu}_{3}\right)}}{\sigma^{4}{\left(z\right)}} & = \det M
\end{align}
where:
\begin{align}
C = &\frac{12  \sigma{\left({\nu}_{1} - {\nu}_{2}\right)} \sigma{\left({\nu}_{1} - {\nu}_{3}\right)} \sigma{\left({\nu}_{2} - {\nu}_{3}\right)} }{\sigma{\left({\nu}_{1}\right)} \sigma^{4}{\left({\nu}_{2}\right)} \sigma^{4}{\left({\nu}_{3}\right)}} \\[6pt]
\det M = &
\begin{vmatrix}
1 & \wp(z) & \frac{\partial \wp(z)}{\partial z} & \frac{\partial^2 \wp(z)}{\partial z^2} \\
1 & \wp(\nu_1) & -\frac{\partial \wp(\nu_1)}{\partial \nu_1} & \frac{\partial^2 \wp(\nu_1)}{\partial \nu_1^2} \\
1 & \wp(\nu_2) & -\frac{\partial \wp(\nu_2)}{\partial \nu_2} & \frac{\partial^2 \wp(\nu_2)}{\partial \nu_2^2} \\
1 & \wp(\nu_3) & -\frac{\partial \wp(\nu_3)}{\partial \nu_3} & \frac{\partial^2 \wp(\nu_3)}{\partial \nu_3^2} \\
\end{vmatrix}  \notag \\[6pt]
= & - 6 \left(\wp{\left({\nu}_{1}\right)} - \wp{\left(z\right)}\right) \left(\wp{\left({\nu}_{2}\right)} - \wp{\left(z\right)}\right) \left(\wp{\left({\nu}_{1}\right)} - \wp{\left({\nu}_{2}\right)}\right) \wp'{\left({\nu}_{3}\right)} \notag \\
& + 6 \left(\wp{\left({\nu}_{1}\right)} - \wp{\left(z\right)}\right) \left(\wp{\left({\nu}_{3}\right)} - \wp{\left(z\right)}\right) \left(\wp{\left({\nu}_{1}\right)} - \wp{\left({\nu}_{3}\right)}\right) \wp'{\left({\nu}_{2}\right)}  \notag \\
& - 6 \left(\wp{\left({\nu}_{2}\right)} - \wp{\left(z\right)}\right) \left(\wp{\left({\nu}_{3}\right)} - \wp{\left(z\right)}\right) \left(\wp{\left({\nu}_{2}\right)} - \wp{\left({\nu}_{3}\right)}\right) \wp'{\left({\nu}_{1}\right)}  \notag \\
& - 6 \left(\wp{\left({\nu}_{1}\right)} - \wp{\left({\nu}_{2}\right)}\right) \left(\wp{\left({\nu}_{1}\right)} - \wp{\left({\nu}_{3}\right)}\right) \left(\wp{\left({\nu}_{2}\right)} - \wp{\left({\nu}_{3}\right)}\right) \wp'{\left(z\right)}
\end{align}

The starting point for us is the following relation established via \eqref{eq:ham-uv}, \eqref{eq:duv_j}, and \eqref{eq:Q-uv}:
\begin{align}
2 \prod_{j=1}^{4} u_j &= - \frac{\partial}{\partial z} u_j\, v_j + {a}_{0} + \sum_{j=1}^{4} {a}_{j} u_j v_j  + \frac{1}{2}\sum\limits_{j,k=1}^{4} {a}_{j,k} u_j v_j u_k v_k, \notag \\
&=\rho' + \sum_{l=0}^{2}b_l\,\rho\left(z\right)^l. \label{eq:fs-det-start}
\end{align}
We will show how \eqref{eq:fs-det-start} can be transformed into \eqref{eq:fs-det-m}

\subsection{The left hand side}
From \eqref{eq:uv-wp}, the right hand side of \eqref{eq:fs-det-start} is a doubly periodic elliptic function,
so too then is the left. Thus for integers $m,n$ and half-periods $\omega_1, \omega_3$ we must have:
\begin{align}
\prod_{j=1}^{4} \frac{u_j{\left(z\right)}}{u_j{\left(2 m {\omega}_{3} + 2 n {\omega}_{1} + z\right)}} & = 1. \label{eq:u-prod-is-one}
\end{align}

We substitute our solution \eqref{eq:u-v-quartic} into \eqref{eq:u-prod-is-one} and use the quasi-periodicity of $\sigma$:
\begin{align}
\sigma{\left(2 m {\omega}_{3} + 2 n {\omega}_{1} + z\right)} = \left(-1\right)^{m n + m + n} \sigma{\left(z\right)} e^{\left(2 m {\omega}_{3} + 2 n {\omega}_{1} + 2 z\right) \zeta{\left(m {\omega}_{3} + n {\omega}_{1}\right)}} \label{eq:quasi-sigma}
\end{align}

to reduce the product in \eqref{eq:u-prod-is-one} to an exponential which, as it is equal to one, must have argument $2\pi i \mathrm{N}(n,m)$, with $\mathrm{N}(n,m)$ an integer that varies with $n,m$.
This leads to:
\begin{align}
2 i \pi \mathrm{N}{\left(n,m \right)} &= - \left(2 m {\omega}_{3} + 2 n {\omega}_{1}\right) \sum_{j=1}^{4} {r}_{0,j} - 2 \zeta{\left(m {\omega}_{3} + n {\omega}_{1}\right)} \sum_{j=1}^{4} {\nu}_{j}, \label{eq:exp-arg-is-one} \\ 
\sum_{j=1}^{4} {\nu}_{j} &= 2 \mathrm{N}{\left(1,0 \right)} {\omega}_{3} - 2 \mathrm{N}{\left(0,1 \right)} {\omega}_{1} = 0 \pmod{\text{lattice}}, \label{eq:nuj-sum-zero}  \\ 
\sum_{j=1}^{4} {r}_{0,j} &= 2 \,\zeta{\left(\mathrm{N}{\left(0,1 \right)} {\omega}_{1} - \mathrm{N}{\left(1,0 \right)} {\omega}_{3}\right)} \label{eq:roj-is-zeta} 
\end{align}

where $\nu_j=\mu_j-z_0$, and in moving from \eqref{eq:exp-arg-is-one} to \eqref{eq:nuj-sum-zero} and \eqref{eq:roj-is-zeta} we made use of the identity $\zeta{\left({\omega}_{3}\right)} {\omega}_{1} - \zeta{\left({\omega}_{1}\right)} {\omega}_{3} = i \pi /2$. 
Ultimately, equations \eqref{eq:quasi-sigma}, \eqref{eq:nuj-sum-zero} and \eqref{eq:roj-is-zeta} allow us to make the following substitution in the left hand side of \eqref{eq:fs-det-start}:
\begin{align}
\frac{\sigma{\left(z + {\nu}_{4} \right)}}{\sigma{\left({\nu}_{4} \right)}}\,\exp{\left(z \sum\limits_{j=1}^{4} {r}_{0,j}\right)} = - \frac{\sigma{\left(z - {\nu}_{1} - {\nu}_{2} - {\nu}_{3} \right)}}{\sigma{\left({\nu}_{1} + {\nu}_{2} + {\nu}_{3} \right)}}
\end{align}

\subsection{The right hand side}
The following algebraic identity follows from Waring-Lagrange interpolation and holds for any values of the variables and functions:
\begin{align}
\sum_{l=0}^{2}b_l\,\rho\left(z\right)^l =\, &\frac{\left({\gamma}_{1} - \rho{\left(z \right)}\right) \left({\gamma}_{2} - \rho{\left(z \right)}\right)}{\left({\gamma}_{1} - {\gamma}_{3}\right) \left({\gamma}_{2} - {\gamma}_{3}\right)} \sum\limits_{l=0}^{2}b_l\,\gamma_1^l + \notag \\
&\frac{\left({\gamma}_{1} - \rho{\left(z \right)}\right) \left({\gamma}_{3} - \rho{\left(z \right)}\right)}{\left({\gamma}_{1} - {\gamma}_{2}\right) \left({\gamma}_{3} - {\gamma}_{2}\right)} \sum\limits_{l=0}^{2}b_l\,\gamma_2^l + \notag \\
&\frac{\left({\gamma}_{2} - \rho{\left(z \right)}\right) \left({\gamma}_{3} - \rho{\left(z \right)}\right)}{\left({\gamma}_{1} - {\gamma}_{2}\right) \left({\gamma}_{1} - {\gamma}_{3}\right)} \sum\limits_{l=0}^{2}b_l\,\gamma_3^l \label{eq:waring-lagrange}
\end{align}

where in our case $\gamma_j=\rho(\mu_j)$ and the sum over $b_l \gamma_j$ can be written using \eqref{eq:drho-sqrd-2} as:
\begin{align}
\sum\limits_{l=0}^{2}b_l\,\gamma_j^l = \rho'\left(\mu_j\right).
\end{align}

We can then use \eqref{eq:uv-wp} to express $\rho$ in terms of $\wp$ so that we can substitute all variables in \eqref{eq:waring-lagrange} for values in terms of $\wp, \wp'$. 
We then divide both sides of \eqref{eq:fs-det-start} by:
\begin{align}
\frac{\wp'{\left(z_{1}\right)}}{\sqrt{{d}_{4}} \left(\wp{\left(z_{1}\right)} - \wp{\left(z - z_{0}\right)}\right)^2 }
\end{align}
and observe that it takes the equivalent form to \eqref{eq:fs-det-m} up to constant factors that may look different but can be shown to be identical by multiplying by $\sigma(z)^4$ and taking $z\rightarrow 0$.

% ---------- APPENDIX ------------
% --------------------------------

\section{Parameter definitions in the bar coordinates}
\label{app:bar-coords-params}

\begin{align}
{d}_{5} &= {d}_{1} + 2 {d}_{2} {\lambda}_{1} + 3 {d}_{3} {\lambda}_{1}^{2} + 4 {d}_{4} {\lambda}_{1}^{3}, \notag  \\
\varsigma & = \frac{1}{2} \left(b_0 + b_1 {\lambda}_{1} + b_2{\lambda}_{1}^2\right) \left(\sqrt{\prod\limits_{j=1}^4 \gamma_j - \lambda_1}\right)^{-1}  = \pm 1, \\
\chi &= \frac{8\left(b_0 + b_1 {\lambda}_{1} + b_2{\lambda}_{1}^2\right)}{d_5} = \frac{16\, \varsigma}{d_5}\sqrt{\prod\limits_{j=1}^4 \gamma_j - \lambda_1}, \notag \\
\bar{\gamma}_{j} &= \frac{{d}_{5}}{4 \left({\gamma}_{j} - {\lambda}_{1}\right)} + \frac{{b}_{1} + 2 {b}_{2} {\lambda}_{1}}{\chi} - \frac{4}{\chi^{2}}, \notag \\
{\theta}_{j} &= \frac{b_0 + b_1 {\lambda}_{1} + b_2{\lambda}_{1}^2}{2\left({\gamma}_{j} - {\lambda}_{1}\right)} + \frac{{b}_{1}}{4} + \frac{{b}_{2} {\gamma}_{j}}{2} + \frac{{b}_{2} {\lambda}_{1}}{2} - \frac{1}{\chi}, \quad \sum\limits_{j=1}^{4} \theta_j = 0, \notag \\
\bar{\kappa}_j &= 2 {\theta}_{j} + \frac{1}{\chi} - {b}_{2} {\gamma}_{j} - \zeta{\left({\mu}_{j} - z_{0}, g_2, g_3\right)}.
\end{align}

% ---------- APPENDIX ------------
% --------------------------------

\section{Scaled parameters in the tilde coordinates}
\label{app:scaled-params}
When the system in subsection \ref{subsec:tilde-coords} (tilde notation) is considered a transform of that in subsection \ref{subsec:bar-coords} (bar notation), then parameters are related via the following scaling laws:
\begin{align}
\tilde{H} &= \chi^3\bar{H}, \\
\tilde{\epsilon}_j &= \epsilon_j \sqrt[4]{\varsigma}, \notag \\
\tilde{\gamma}_j &= \chi^2\bar{\gamma}_j, \notag \\
\tilde{g}_2 &= \chi^4 g_2, \notag \\
\tilde{g}_3 &= \chi^6 g_3, \notag \\
\xi_0 &= \frac{z_0}{\chi}, \notag \\
\tilde{\mu}_j &= \frac{\mu_j}{\chi}.
\end{align}

If the system in subsection \ref{subsec:tilde-coords} is considered as a standalone system irrespective of any transformation,
then the paramters can be given exclusively in the coordinate system denoted by tilde notation as follows.
Firstly, $\tilde{H}$ can be obtained from substituting $\tilde{u}_j{\left(0\right)}, \tilde{v}_j{\left(0 \right)}$ into \eqref{eq:H-tilde}
and $\tilde{\epsilon}_j$ can be considered an integration constant fixed by initial conditions to capture any phase offset between $\tilde{u}_j, \tilde{v}_j$. 
We may further use relations:
\begin{align}
\tilde{\gamma}_{j} =& \tilde{u}_j{\left(0\right)} \tilde{v}_j{\left(0 \right)} - \frac{1}{4}\sum_{j=1}^{4} \tilde{u}_j{\left(0\right)} \tilde{v}_j{\left(0\right)}, \notag \\
\tilde{g}_{2} =& \frac{\tilde{H}^{2}}{12} + \tilde{H} \left(\frac{{\tilde{e}}_{2}}{12} + \frac{16}{3}\right) + \frac{{\tilde{e}}_{2}^{2}}{48} + \frac{2 {\tilde{e}}_{2}}{3} - \frac{{\tilde{e}}_{3}}{4} + \frac{64}{3}, \notag \\
\tilde{g}_{3} =& \frac{\tilde{H}^{3}}{216} + \tilde{H}^{2} \left(\frac{{\tilde{e}}_{2}}{144} - \frac{5}{9}\right) + \tilde{H} \left(\frac{{\tilde{e}}_{2}^{2}}{288} - \frac{2 {\tilde{e}}_{2}}{9} - \frac{{\tilde{e}}_{3}}{48} - \frac{64}{9}\right) \notag \\
&+ \frac{{\tilde{e}}_{2}^{3}}{1728} - \frac{5 {\tilde{e}}_{2}^{2}}{144} - \frac{{\tilde{e}}_{2} {\tilde{e}}_{3}}{96} - \frac{8 {\tilde{e}}_{2}}{9} + \frac{{\tilde{e}}_{3}}{3} + \frac{{\tilde{e}}_{4}}{4} - \frac{512}{27}
\end{align}
where $\tilde{e}_j=\tilde{e}_j\left(\tilde{\gamma}_1, \tilde{\gamma}_2, \tilde{\gamma}_3, \tilde{\gamma}_4\right)$ is the $j^{th}$ order \emph{elementary symmetric polynomial} formed with the four $\tilde{\gamma}_j$, and the points $\xi_0, \tilde{\mu}_j$ can be found by inverting:
\begin{align}
\wp{\left(\xi_{0},\tilde{g}_{2},\tilde{g}_{3} \right)} &= - \frac{\tilde{H}}{12} - \frac{{\tilde{e}}_{2}}{24} - \frac{\sum_{j=1}^{4} \tilde{u}{\left(0,{\mu}_{j} \right)} \tilde{v}{\left(0,{\mu}_{j} \right)}}{4} + \frac{4}{3}, \notag \\
\wp'{\left(\xi_{0},\tilde{g}_{2},\tilde{g}_{3} \right)} &= \frac{1}{4}\left(\prod_{j=1}^{4}{\tilde{u}_j(0)} - \prod_{j=1}^{4}{\tilde{v}_j(0)}\right), \notag \\
\wp{\left({\tilde{\mu}}_{j} - \xi_{0},\tilde{g}_{2},\tilde{g}_{3} \right)} &= - \frac{\tilde{H}}{12} - \frac{{\tilde{e}}_{2}}{24} + {\tilde{\gamma}}_{j} + \frac{4}{3}, \notag \\
\wp'{\left({\tilde{\mu}}_{j} - \xi_{0},\tilde{g}_{2},\tilde{g}_{3} \right)} &= \tilde{H} + \frac{{\tilde{e}}_{2}}{4} - \frac{{\tilde{\gamma}}_{j}^{2}}{2} - 4 {\tilde{\gamma}}_{j}.
\end{align}

\printbibliography

\end{document}
